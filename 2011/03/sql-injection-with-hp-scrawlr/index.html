<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Hackecho</title>
    <meta name="description" content="">
    <meta name="author" content="Zhaoyu Li">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://hackecho.com/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="http://hackecho.com/theme/bootstrap.min.css" rel="stylesheet">
    <link href="http://hackecho.com/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="http://hackecho.com/theme/local.css" rel="stylesheet">
    <link href="http://hackecho.com/theme/pygments.css" rel="stylesheet">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="http://hackecho.com">Hackecho</a>

        <div class="nav-collapse">
        <ul class="nav">
                    <li><a href="/archives.html">Archives</a></li>
                    <li><a href="/tags.html">Tags</a></li>
                    
                            <li><a href="http://hackecho.com/pages/about.html">About</a></li>
                    <li><a href="http://hackecho.com/pages/guestbook.html">Guestbook</a></li>
                        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
            <div class='article'>
        <div class="content-title">
            <h1>用HP Scrawlr检测数据库SQL注入漏洞</h1>
            Wed 30 March 2011

by <a class="url fn" href="http://hackecho.com/author/zhaoyu-li.html">Zhaoyu Li</a>
 


        </div>
	
        <div><p>您需要是不是正要检测在线数据库的漏洞呢？正好，HP为我们提供了一个免费工具来检测网站是否存在SQL注入漏洞。HP Scrawlr能够爬行您的站点，以查找代码中的安全漏洞。这款软件是免费的，并且很容易上手。</p>
<p><strong>引言</strong></p>
<p>SQL数据库是目前世界上最快的一种数据库，每秒钟可以完成数百万次的事务处理。使用PHP和ASP代码处理SQL连接的时候，如果代码写的不好的 话，就会为网站的安全留下隐患：黑客可以通过插入代码来获得您的服务器上数据库的控制权。所以，一定要保护好您的SQL数据库。测试软件和网络的安全性应 该成为安全审计的一部分。HP为我们提供了扫描网站的SQL漏洞的免费软件。Scrawlr只可用于合法地扫描您自己的站点，而不得用于您的组织之外的站 点。安全分析人员进行渗透测试时，应当将这款软件也纳入到他们的安全工具库中。</p>
<p><strong>HP Scrawlr</strong></p>
<p>Hewlett  Packard公司提供了一款免费的工具，供人们用来爬行他们的站点，并从中查找安全漏洞。Scrawlr是由HP的web安全研究团队开发的，可用于对 单独的网页进行SQL注入漏洞的检测和利用。这个程序运行速度非常快；在运行期间，它可以利用HP的智能引擎技术来创建和动态执行SQL注入。最后，它还 能提高一份简单的报告来供管理员分析有关结果。如果该程序成功的话，您就会看到数据库和各种表。</p>
<p><strong>Scrawlr</strong></p>
<p>下面是Scrawlr的两个截图：</p>
<p><img alt="" src="http://images.51cto.com/files/uploadimg/20091009/1527390.jpg" /></p>
<p><img alt="" src="http://images.51cto.com/files/uploadimg/20091009/1527391.jpg" /></p>
<p><strong>SQL注入</strong></p>
<p>黑客可以使用简单的SQL命令来进行插入、删除操作，甚至能控制整个数据库。黑客可以先在web中查找数据库，然后通过简单的注入命令来返回机密数据，并将其复制粘贴到自己的机器中。下面是一个简单的SQL注入范例：</p>
<p>下面我们来绕过登录表单。这里是来自实际应用代码片段：</p>
<div class="codehilite"><pre><span class="n">SQLQuery</span> <span class="p">=</span> &quot;<span class="n">SELECT</span> <span class="n">Username</span> <span class="n">FROM</span> <span class="n">Users</span> <span class="n">WHERE</span>
<span class="n">Username</span> <span class="p">=</span> ‘&quot; <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span>
<span class="n">strUsername</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> &quot;‘ <span class="n">AND</span> <span class="n">Password</span> <span class="p">=</span> ‘&quot; <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">strPassword</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> &quot;‘&quot;
<span class="n">strAuthCheck</span> <span class="p">=</span> <span class="n">GetQueryResult</span><span class="p">(</span><span class="n">SQLQuery</span><span class="p">)</span>
<span class="n">If</span> <span class="n">strAuthCheck</span> <span class="p">=</span> &quot;&quot; <span class="n">Then</span>
    <span class="n">boolAuthenticated</span> <span class="p">=</span> <span class="n">False</span>
<span class="n">Else</span>
    <span class="n">boolAuthenticated</span> <span class="p">=</span> <span class="n">True</span>
<span class="n">End</span> <span class="n">If</span>
</pre></div>


<p>这是一个典型的登录处理，终端用户来到站点，然后提交他们的用户名和口令。随后，这个查询从“Users”表中寻找是否有与提供的用户名和口令匹配的记录。对于糟糕的ASP代码或者PHP代码，黑客将能使用下列类型的代码来发动进攻。</p>
<p><strong>注入代码：</strong></p>
<div class="codehilite"><pre>用户名：‘ <span class="n">OR</span> ‘‘<span class="p">=</span>‘
口令：‘ <span class="n">OR</span> ‘‘<span class="p">=</span>‘
</pre></div>


<p>这个会使SQLQuery变成下面的样子：</p>
<div class="codehilite"><pre><span class="n">SELECT</span> <span class="n">Username</span> <span class="n">FROM</span> <span class="n">Users</span> <span class="n">WHERE</span> <span class="n">Username</span> <span class="p">=</span> ‘‘
<span class="n">OR</span> ‘‘<span class="p">=</span>‘‘ <span class="n">AND</span>
<span class="n">Password</span> <span class="p">=</span> ‘‘ <span class="n">OR</span> ‘‘<span class="p">=</span>‘‘
</pre></div>


<p>这样，黑客只是在应该输入有效用户名的地方键入了一个字符串：‘ OR ‘‘=‘，就轻而易举地绕过了登录屏。</p>
<p><strong>结束语</strong></p>
<p>执行SQL注入的方法数以千计，这里介绍的并不是理想的“黑客”代码。本文不是关于黑客技术的，而是关于如何保护您的网站的。  HP只是众多能够保护您的网站中的工具之一。对于保护您的信息资产来说，渗透测试是一种重要的手段。它不仅有助于测试代码，而且还能帮您测试防火墙。不过 Scrawlr软件也有其不足之处，例如：</p>
<p>•最多只能爬行1500个URL地址</p>
<p>•在爬行期间无法进行脚本解析</p>
<p>•在爬行期间无法解析Flash</p>
<p>•在爬行期间无法提交表单</p>
<p>•仅有简单的代理支持</p>
<p>•没有身份验证或者登录功能</p>
<p>•不能检测SQL盲注</p>
<p>任何软件都不是十全十美的，但是它们对于安全漏洞和漏洞利用测试来说确实是非常有帮助的。如果站点仅通过了一种安全软件的测试，就以为高枕无忧那就太盲目了。感谢HP有为我们带来了一个软件“帮手”！</p></div>
	
        <hr>
    	   
        <h2>Comments</h2>
		<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'zlmoment'; 

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
        </div>
        
        <div class="span3">

            <!--<div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                RSS
                </li>
                <li><a href="http://hackecho.com/" rel="alternate">Atom feed</a></li>
                            </ul>
            </div>
            -->


                        <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                                <li><a href="http://hackecho.com/category/develope.html">Develope</a></li>
                                <li><a href="http://hackecho.com/category/life.html">Life</a></li>
                                <li><a href="http://hackecho.com/category/other.html">Other</a></li>
                                   
            </ul>
            </div>
            

                        <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Links
                </li>
            
                            <li><a href="http://yilee.info/">异泪</a></li>
                            <li><a href="http://www.gaodayue.com/">Gaodayue的日志</a></li>
                            <li><a href="http://ilifezen.com/">iLifeZen</a></li>
                            <li><a href="http://techeric.info/">远方</a></li>
                            <li><a href="http://mingplusplus.com/blog/">Ming++</a></li>
                            <li><a href="http://tsenmu.com/">Tsenmu</a></li>
                            <li><a href="http://www.binghe.org/">冰河的博客</a></li>
                        </ul>
            </div>
            

                        <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                                <li><a href="https://www.facebook.com/hackecho">Facebook</a></li>
                                <li><a href="https://twitter.com/zlmoment">Twitter</a></li>
                                <li><a href="http://weibo.com/zhaoyulee">微博</a></li>
                            </ul>
            </div>
            </div>
            
        </div>  
    </div>     </div> 
<footer>
<br />
<p><a href="http://hackecho.com">Hackecho</a> &copy; Zhaoyu Li 2012</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
<script>var _gaq=[['_setAccount','UA-37227120-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
 
</body>
</html>